<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <title>Listagem de Vagas</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <h1>Vagas Disponíveis</h1>

  <table border = "1">
    <thead>
      <tr>
        <th>Vaga</th>
        <th>Status</th>
        <th>Placa</th>
        <th>Proprietário</th>
        <th>Contato</th>
      </tr>
    </thead>
    <tbody id="corpo-tabela">
        <!--JavaScript vai inserir as reservas aqui-->
    </tbody>
  </table>
  
  <a href="index.html">
    <button type="button">Voltar para o cadastro</button>
  </a>

  <script>

    // Pega o elemento <tbody id="corpo-tabela"> da página
    const corpoTabela = document.getElementById("corpo-tabela");
    const totalDeVagas = 15;

    //pega reservas salvas
    const reservas = JSON.parse(localStorage.getItem("reservas")) || [];
    
    //Cria uma lista apenas com o numero das vagas ocupadas
    const VagasOcupadas = reservas.map(r => parseInt(r.numero_vaga));

    //De 1 até o total de vagas
    for ( let vaga = 1;vaga <= totalDeVagas;vaga++) {
        const linha = document.createElement("tr");

        //Verifica se a vaga está na lista de ocupadas
        const reserva = reservas.find(r => parseInt(r.numero_vaga) === vaga);

        if(reserva) {
            //Se a vaga estiver ocupada, preenche com os dados da reserva
            linha.innerHTML = `
            <td>${vaga}</td>
            <td>Ocupada</td>
            <td>${reserva.placa_veiculo}</td>
            <td>${reserva.nome}</td>
            <td>${reserva.numero_celular}</td>
            `;
        } else {
            //Se não, preenche como vaga disponível
            linha.innerHTML = `
            <td>${vaga}</td>
            <td>Disponivel</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            `;
        }

        corpoTabela.appendChild(linha);
    }

  </script>
  
</body>

</html>